<body>
  <h1>Humanity Index</h1>
  <p id="headline"></p>
  <h2>Trend Over Time</h2>
  <canvas id="hiChart" width="400" height="200"></canvas>

  <script>
    async function loadData() {
      const latestResp = await fetch("data/latest.json");
      const seriesResp = await fetch("data/index_series.json");
      const latest = await latestResp.json();
      const series = await seriesResp.json();

      // Headline section
      const headline = document.getElementById("headline");
      const today = latest.hi;
      const yesterday = series[series.length - 2]?.HI ?? 0;
      const diff = today - yesterday;
      const arrow = diff >= 0 ? "↑ better" : "↓ worse";
      headline.textContent = `Last updated ${latest.date} • Change vs yesterday: ${diff} (${arrow})`;

      // Chart section
      const ctx = document.getElementById("hiChart").getContext("2d");
      new Chart(ctx, {
        type: "line",
        data: {
          labels: series.map(d => d.date),
          datasets: [{
            label: "HI",
            data: series.map(d => d.HI),
            borderColor: "blue",
            fill: false
          }]
        },
        options: {
          scales: {
            y: {
              beginAtZero: false,
              min: -100,
              max: 100
            }
          }
        }
      });
    }
    loadData();
  </script>
</body>
